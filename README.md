# ささっと音声メモ Chrome拡張機能

音声録音とOpenAI Whisper APIを使用したAI文字起こしによる簡単メモツールです。

## 機能

- 🎤 **音声録音**: マイクを使用した高品質音声録音（最大5分、設定変更可能）
- 🤖 **AI文字起こし**: OpenAI Whisper APIによる高精度な日本語文字起こし
- 📝 **統合履歴管理**: 全ての録音を時系列で一画面表示（最大30件）
- ✏️ **リアルタイム編集**: 文字起こし結果の直接編集機能
- 📋 **ワンクリックコピー**: クリップボードへの瞬時コピー
- 💰 **詳細料金表示**: 各録音のAPI使用料金、時間、ファイルサイズを表示
- 🔧 **スマート設定管理**: APIキーの安全保存と状況に応じた案内表示
- 🚀 **ワンクリックアクセス**: 拡張機能アイコンクリックで即座に起動

## インストール方法

### 1. ファイルの準備
このフォルダ全体をローカルにダウンロードまたはコピーしてください。

### 2. Chrome拡張機能として読み込み
1. Google Chromeを開く
2. アドレスバーに `chrome://extensions/` と入力してEnter
3. 右上の「デベロッパーモード」をオンにする
4. 「パッケージ化されていない拡張機能を読み込む」をクリック
5. このフォルダを選択する

### 3. OpenAI APIキーの設定
1. [OpenAI Platform](https://platform.openai.com/api-keys) でAPIキーを取得
2. Chrome拡張機能のアイコンをクリックしてサイドバーを表示
3. 「設定」ボタンをクリック
4. APIキーを入力して保存
5. APIキー設定後は案内メッセージが自動的に非表示になります

## 使用方法

### 基本的な使い方
1. Chrome拡張機能のアイコンをクリック（サイドバーが直接表示されます）
2. 初回利用時は「設定」ボタンからOpenAI APIキーを入力
3. サイドバーの「🎤 録音開始」ボタンをクリック
4. マイクの使用許可を与える
5. 録音完了後、自動的にAI文字起こしが実行されます
6. 結果が履歴リストに表示されます

### 録音操作
- **録音開始**: 黄色の「🎤 録音開始」ボタンをクリック
- **録音停止**: 赤色の「⏹️ 録音停止」ボタンをクリック
- **キャンセル**: 録音中に「❌ キャンセル」ボタンで録音を破棄
- **録音時間**: 最大5分（設定で変更可能）

### 履歴管理
- **表示**: 全ての録音が時系列で一つのリストに表示
- **編集**: 文字起こしテキストをクリックして直接編集可能
- **コピー**: 各履歴の「コピー」ボタンで内容をクリップボードにコピー
- **削除**: 個別の「削除」ボタンまたは「全削除」ボタンで管理
- **自動削除**: 31件目以降は古いものから自動的に削除
- **詳細情報**: 各録音の時間、ファイルサイズ、API使用料金を表示

## システム要件

- Google Chrome（最新版推奨）
- マイクアクセス許可
- インターネット接続（API通信のため）
- OpenAI APIキー

## 注意事項

- **APIキーの管理**: APIキーは暗号化されて安全に保存されますが、他の人と共有しないでください
- **録音時間制限**: デフォルト5分（設定で1-5分に変更可能）
- **プライバシー**: 音声データはOpenAIのサーバーに送信されて処理されます
- **料金**: Whisper API使用料金が発生します（約$0.006/分、各録音に詳細表示）
- **自動削除**: 履歴は31件目以降自動削除されます
- **ブラウザ要件**: 最新のGoogle Chromeでの使用を推奨

## トラブルシューティング

### サイドバーが表示されない場合
- 拡張機能が正しくインストールされているか確認
- ブラウザを再起動して再試行
- 拡張機能を無効化→有効化で再試行

### 録音ができない場合
- ブラウザのマイクアクセス許可を確認（設定 > プライバシーとセキュリティ > サイトの設定）
- 他のアプリケーションがマイクを使用していないか確認
- ページを再読み込みして再試行

### 文字起こしができない場合
- インターネット接続を確認
- OpenAI APIキーが正しく設定されているか確認（設定画面で再入力）
- OpenAI API使用制限や残高を確認
- APIキー設定後、案内メッセージが消えるか確認

### 履歴が表示されない・同期されない場合
- Chrome拡張機能の同期設定を確認
- 別のデバイスでChromeにログインしている場合、同期に時間がかかる場合があります
- ローカルストレージがフォールバックとして使用されます

## ファイル構成

```
ささっと音声メモ_拡張/
├── manifest.json          # Chrome拡張機能のマニフェスト（v3）
├── content.js             # メイン機能のJavaScript（サイドバーUI、録音、文字起こし）
├── sidebar.css            # サイドバーのスタイル（クリーンデザイン）
├── background.js          # バックグラウンドスクリプト（アイコンクリック処理）
├── popup.html             # ポップアップUI（参考用、現在は未使用）
├── popup.js               # ポップアップのJavaScript（参考用、現在は未使用）
├── icons/                 # アイコンファイル
│   ├── icon16.png
│   ├── icon32.png
│   ├── icon48.png
│   └── icon128.png
├── icon.svg              # SVGアイコン（参考用）
├── README.md             # このファイル
├── cursor_.md            # 開発メモ
└── voice_memo_requirements.md # 要件定義書
```

## 技術仕様

- **音声録音**: Web Audio API + MediaRecorder API（高品質録音）
- **文字起こし**: OpenAI Whisper API（日本語最適化）
- **データ保存**: Chrome Storage API (chrome.storage.sync) + localStorage フォールバック
- **UI**: サイドバー形式（固定幅400px、一画面完結型クリーンデザイン）
- **対応サイト**: 全てのWebサイトで動作
- **操作方式**: ワンクリックアクセス（ポップアップなし）
- **料金計算**: リアルタイムでAPI使用料金を正確に計算・表示

## 更新履歴

### v1.05 (最新)
- 🎯 **UI最適化**: サイドバーの情報表示を整理
  - 録音時間上限とAPI合計料金の表示を削除（設定画面で確認可能）
  - 各録音に詳細コスト情報が表示されるため重複を解消
- 🔔 **スマート通知**: APIキー設定状況に応じた通知表示
  - APIキー未設定時のみ「設定ボタンからAPIキーを入力してください」を表示
  - APIキー設定済みの場合は通知を非表示
- 🚀 **ワンクリックアクセス**: 拡張機能の操作を簡素化
  - ポップアップメニューを削除
  - アイコンクリックで直接サイドバーを表示

### v1.04
- 🔄 **UIの大幅簡素化**: タブ機能を完全に削除して一つの画面に統一
  - 録音コントロール、設定情報、全履歴を一つの画面に配置
  - タブ切り替えの問題を根本的に解決
  - よりシンプルで直感的なユーザーインターフェースに改善
  - 全ての録音履歴を一つのリストで確認可能

### v1.03
- 🔧 **タブ切り替えの完全修正**: 録音タブと履歴タブの表示を完全に分離
  - 録音タブ: 録音コントロールと最新録音のみ表示（履歴は表示されない）
  - 履歴タブ: 過去の録音履歴のみ表示（最新録音は除外）
  - 初期化時の不要な表示を排除
  - タブ切り替え時の動的コンテンツ読み込みを実装

### v1.02
- 🔀 **タブ機能の改善**: 録音画面と履歴画面の明確な分離
  - 録音タブ: 録音コントロール + 最新録音結果のみ表示
  - 履歴タブ: 過去の録音履歴（2件目以降）のみ表示
  - タブの切り替えが正しく動作するように修正
- 🎯 **UIレイアウトの最適化**: 録音画面の空間使用を改善
  - 録音ボタン下の不要な空白を解消
  - 最新録音結果を専用セクションに表示
  - より直感的で使いやすいインターフェースに改善

### v1.01
- 🎨 **デザイン刷新**: シンプルで清潔なUIに全面リニューアル
  - 白ベース・黒文字・黄色アクセントのクリーンなデザイン
  - ボタンや入力フィールドをミニマルスタイルに統一
  - 視覚効果（影・グラデーション）を最小化
- 💰 **API料金表示の詳細化**: より具体的なコスト情報を提供
  - 正確な音声長計算（秒単位）
  - ファイルサイズとUSD/JPY両方の料金表示
  - 履歴項目に詳細なコスト情報を追加
  - 設定画面に平均コスト、料金レート、最小課金情報を追加
- 📐 **レイアウト改善**: サイドバーの空間効率を大幅向上
  - フレックスレイアウトで下部4/5の空間を有効活用
  - 履歴リストの表示領域を最大化
  - 各セクションの配置を最適化

### v1.0.0: 初回リリース
- 基本的な録音・文字起こし機能
- 履歴管理機能
- 設定機能

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## サポート

問題が発生した場合は、以下を確認してください：

### 基本チェック項目
1. **拡張機能**: Chrome拡張機能が最新版（v1.05）であること
2. **APIキー**: OpenAI APIキーが正しく設定されていること
3. **権限**: マイクアクセス許可が付与されていること
4. **接続**: インターネット接続が安定していること

### 設定確認方法
1. 拡張機能アイコンをクリックしてサイドバーを表示
2. APIキー未設定の場合、案内メッセージが表示されます
3. 「設定」ボタンから設定画面を開き、各項目を確認

### よくある解決方法
- ブラウザの再起動
- 拡張機能の再読み込み（無効化→有効化）
- APIキーの再入力
- マイク権限の再設定

技術的な問題や詳細なサポートについては、開発者にお問い合わせください。